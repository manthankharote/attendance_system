<%- include('partials/_header') %>
<%- include('partials/_nav', { user: user }) %>

<main class="container">
    <h1>Admin Dashboard</h1>
    
    <div class="grid-container" style="grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));">
        <div class="card">
            <h2>Total Students</h2>
            <p class="stat-number"><%= studentCount %></p>
        </div>
        <div class="card">
            <h2>Total Teachers</h2>
            <p class="stat-number"><%= teacherCount %></p>
        </div>
        <div class="card">
            <h2>Total Classes</h2>
            <p class="stat-number"><%= classCount %></p>
        </div>
    </div>

    <div class="card">
        <h2>Today's Attendance (<%= new Date().toLocaleDateString() %>)</h2>
        <div style="display: flex; justify-content: space-around; text-align: center;">
            <div>
                <p class="stat-number" style="color: var(--success-color);"><%= presentToday %></p>
                <p>Present</p>
            </div>
            <div>
                <p class="stat-number" style="color: var(--danger-color);"><%= absentToday %></p>
                <p>Absent</p>
            </div>
        </div>
    </div>

    <div class="card">
        <h2>Low Attendance Alerts (< 75%)</h2>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Student Name</th>
                        <th>School ID</th>
                        <th>Attendance %</th>
                    </tr>
                </thead>
                <tbody>
                    <% lowAttendanceStudents.forEach(student => { %>
                        <tr>
                            <td><%= student.name %></td>
                            <td><%= student.schoolId %></td>
                            <td style="color: var(--danger-color); font-weight: bold;"><%= student.percentage.toFixed(2) %>%</td>
                        </tr>
                    <% }); %>
                    <% if (lowAttendanceStudents.length === 0) { %>
                        <tr>
                            <td colspan="3" style="text-align: center;">No students with low attendance.</td>
                        </tr>
                    <% } %>
                </tbody>
            </table>
        </div>
    </div>
</main>
<style>
    .stat-number { font-size: 2.5rem; font-weight: 700; text-align: center; margin: 0.5rem 0; }
</style>
</body>
</html>